<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Panel Admina</title>
  <style>
    body {
      font-family: Arial, sans-serif;
    }
    .sidebar {
      width: 200px;
      background-color: #333;
      color: white;
      position: fixed;
      height: 100%;
      overflow: auto;
    }
    .sidebar a {
      display: block;
      color: white;
      padding: 10px;
      text-decoration: none;
    }
    .sidebar a:hover {
      background-color: #575757;
    }
    .content {
      margin-left: 210px;
      padding: 20px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    table, th, td {
      border: 1px solid black;
    }
    th, td {
      padding: 10px;
      text-align: left;
    }

    .add-row-btn {
      margin-left: 10px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 4px;
      padding: 5px 10px;
      cursor: pointer;
      font-size: 16px;
    }

    .add-row-btn:hover {
      background-color: #45a049;
    }

    .submit-btn {
      margin-top: 10px;
      background-color: #008CBA;
      color: white;
      border: none;
      padding: 10px 15px;
      cursor: pointer;
      border-radius: 4px;
    }
    .submit-btn:hover {
      background-color: #007B9A;
    }
    button {
      font-size: 14px;
      margin-left: 5px;
    }

    button:hover {
      background-color: #45a049;
    }

    button.logout-btn {
      background-color: #FF5722;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      margin-bottom: 20px;
    }

    button.logout-btn:hover {
      background-color: #E64A19;
    }


  </style>
</head>
<body>
<div class="sidebar">
  <h2>Panel Admina</h2>
  <a href="#Klienci">Klienci</a>
  <a href="#Bilety">Bilety</a>
  <a href="#Pracownicy">Pracownicy</a>
  <a href="#Atrakcje">Atrakcje</a>
  <a href="#Obiekty_uslugowe">Obiekty</a>
  <a href="#Strefy">Strefy</a>
  <a href="#Wlasciciele">Właściciele</a>
  <button onclick="window.location.href='/logout'" class="logout-btn">
    Wyloguj się
  </button>
</div>
<div class="content">
  <h1 id="zakladka1">Klienci</h1>
  <table>
    <thead>
    <tr>
      <th>ID Klienta</th>
      <th>Imię</th>
      <th>Nazwisko</th>
      <th>Czas Wejścia</th>
      <th>Czas Wyjścia</th>
      <th>Liczba Biletów</th>
      <th>Wiek</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="klient : ${klienci}">
      <td th:text="${klient.idKlienta}"></td>
      <td th:text="${klient.imie}"></td>
      <td th:text="${klient.nazwisko}"></td>
      <td th:text="${klient.czasWejscia}"></td>
      <td th:text="${klient.czasWyjscia}"></td>
      <td th:text="${klient.liczbaBiletow}"></td>
      <td th:text="${klient.wiek}"></td>
    </tr>
    </tbody>
  </table>

  <h1 id="zakladka2">Zakupione bilety</h1>
  <table>
    <thead>
    <tr>
      <th>Rodzaj Biletu</th>
      <th>Data Zakupu</th>
      <th>Długość Biletu</th>
      <th>Cena</th>
      <th>ID Pracownika</th>
      <th>ID Klienta</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="bilet : ${bilety}">
      <td th:text="${bilet.rodzajBiletu}"></td>
      <td th:text="${bilet.dataZakupu}"></td>
      <td th:text="${bilet.dlugoscBiletu}"></td>
      <td th:text="${bilet.cena}"></td>
      <td th:text="${bilet.idPracownika}"></td>
      <td th:text="${bilet.idKlienta}"></td>
    </tr>
    </tbody>
  </table>


  <h1>Pracownicy

  </h1>
  <table id="Pracownicy">

    <thead>
    <tr>
      <th>Adres</th>
      <th>ID Pracownika</th>
      <th>Imię</th>
      <th>Nazwisko</th>
      <th>PESEL</th>
      <th>ID Managera</th>
      <th>Data Zatrudnienia</th>
      <th>Wynagrodzenie</th>
      <th>Nr Telefonu</th>
      <th>FK ID Pracownika</th>
      <th>ID Stanowiska</th>
      <th>Akcje</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="pracownik : ${pracownicy}">
      <td th:text="${pracownik.adres}"></td>
      <td th:text="${pracownik.idPracownika}"></td>
      <td th:text="${pracownik.imie}"></td>
      <td th:text="${pracownik.nazwisko}"></td>
      <td th:text="${pracownik.pesel}"></td>
      <td th:text="${pracownik.idManagera}"></td>
      <td th:text="${pracownik.dataZatrudnienia}"></td>
      <td th:text="${pracownik.wynagrodzenie}"></td>
      <td th:text="${pracownik.nrTelefonu}"></td>
      <td th:text="${pracownik.fkIdPracownika}"></td>
      <td th:text="${pracownik.idStanowiska}"></td>
    </tr>
    </tbody>
  </table>




  <h1 >Atrakcje </h1>
  <table id="Atrakcje">
    <thead>
    <tr>
      <th>ID Atrakcji</th>
      <th>Nazwa</th>
      <th>Typ</th>
      <th>Ograniczenie Wieku</th>
      <th>Stan</th>
      <th>Max Liczba Osób</th>
      <th>ID Strefy</th>
      <th>ID Typu Atrakcji</th>
      <th>ID Parku</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="atrakcja : ${atrakcje}">
      <td th:text="${atrakcja.idAtrakcji}"></td>
      <td th:text="${atrakcja.nazwa}"></td>
      <td th:text="${atrakcja.typ}"></td>
      <td th:text="${atrakcja.ograniczenieWieku}"></td>
      <td th:text="${atrakcja.stan}"></td>
      <td th:text="${atrakcja.maxLiczbaOsob}"></td>
      <td th:text="${atrakcja.idStrefy}"></td>
      <td th:text="${atrakcja.idTypuAtrakcji}"></td>
      <td th:text="${atrakcja.idParku}"></td>
    </tr>
    </tbody>
  </table>


  <h1 >Obiekty  </h1>
  <table id="Obiekty_uslugowe">
    <thead>
    <tr>
      <th>ID Obiektu</th>
      <th>Nazwa</th>
      <th>Kategoria</th>
      <th>Data Najmu</th>
      <th>Czynsz</th>
      <th>ID Strefy</th>
      <th>ID Właściciela</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="obiekt : ${obiekty}">
      <td th:text="${obiekt.idObiektu}"></td>
      <td th:text="${obiekt.nazwa}"></td>
      <td th:text="${obiekt.kategoria}"></td>
      <td th:text="${obiekt.dataNajmu}"></td>
      <td th:text="${obiekt.czynsz}"></td>
      <td th:text="${obiekt.idStrefy}"></td>
      <td th:text="${obiekt.idWlasciciela}"></td>
    </tr>
    </tbody>
  </table>


  <h1 >Strefy  </h1>
  <table id="Strefy">
    <thead>
    <tr>
      <th>ID Strefy</th>
      <th>Ograniczenie Wieku</th>
      <th>Nazwa</th>
      <th>ID Parku</th>
      <th>ID Pracownika</th>
      <th>ID Typu Strefy</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="strefa : ${strefy}">
      <td th:text="${strefa.idStrefy}"></td>
      <td th:text="${strefa.ograniczenieWieku}"></td>
      <td th:text="${strefa.nazwa}"></td>
      <td th:text="${strefa.idParku}"></td>
      <td th:text="${strefa.idPracownika}"></td>
      <td th:text="${strefa.idTypuStrefy}"></td>
    </tr>
    </tbody>
  </table>

  <h1 >Właściciele  </h1>
  <table id="Wlasciciele">
    <thead>
    <tr>
      <th>ID Właściciela</th>
      <th>Imię</th>
      <th>Nazwisko</th>
      <th>Nazwa Firmy</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="wlasciciel : ${wlasciciele}">
      <td th:text="${wlasciciel.idWlasciciela}"></td>
      <td th:text="${wlasciciel.imie}"></td>
      <td th:text="${wlasciciel.nazwisko}"></td>
      <td th:text="${wlasciciel.nazwaFirmy}"></td>
    </tr>
    </tbody>
  </table>




</div>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const addRowButton = document.querySelector('.add-row-btn[data-table="Pracownicy"]');
    addRowButton.addEventListener('click', () => {
      const table = document.getElementById('Pracownicy');
      const tbody = table.querySelector('tbody');
      const newRow = tbody.insertRow();

      const columns = ['adres', 'idPracownika', 'imie', 'nazwisko', 'pesel', 'idManagera', 'dataZatrudnienia', 'wynagrodzenie', 'nrTelefonu', 'fkIdPracownika', 'idStanowiska'];
      columns.forEach(() => {
        const cell = newRow.insertCell();
        cell.innerHTML = '<input type="text" style="width: 100%;">';
        cell.innerHTML = '<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />\n';
      });

      const actionCell = newRow.insertCell();
      const saveButton = document.createElement('button');
      saveButton.textContent = 'Zapisz';
      saveButton.classList.add('save-new-btn');
      actionCell.appendChild(saveButton);
    });

    // Obsługa zapisu nowego pracownika
    document.addEventListener('click', (e) => {
      if (e.target.classList.contains('save-new-btn')) {
        const button = e.target;
        const row = button.closest('tr');
        const inputs = row.querySelectorAll('input');
        const data = {};

        const columns = ['adres', 'idPracownika', 'imie', 'nazwisko', 'pesel', 'idManagera', 'dataZatrudnienia', 'wynagrodzenie', 'nrTelefonu', 'fkIdPracownika', 'idStanowiska'];
        inputs.forEach((input, index) => {
          data[columns[index]] = input.value;
        });

        fetch('/pracownicy/add', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data),
        }).then(response => {
          if (response.ok) {
            alert('Pracownik został dodany.');
            inputs.forEach(input => {
              const cell = input.parentElement;
              cell.textContent = input.value;
            });
            button.remove();
          } else {
            alert('Wystąpił błąd podczas dodawania pracownika.');
          }
        });
      }
    });
  });
  document.addEventListener('click', (e) => {
    if (e.target.classList.contains('save-btn')) {
      const button = e.target;
      const row = button.closest('tr');
      const cells = row.querySelectorAll('td');

      const data = {
        idPracownika: button.dataset.id,
        adres: cells[0].querySelector('input').value,
        imie: cells[2].querySelector('input').value,
        nazwisko: cells[3].querySelector('input').value,
        pesel: cells[4].querySelector('input').value,
        idManagera: cells[5].querySelector('input').value || null,
        dataZatrudnienia: cells[6].querySelector('input').value,
        wynagrodzenie: cells[7].querySelector('input').value,
        nrTelefonu: cells[8].querySelector('input').value,
        fkIdPracownika: cells[9].querySelector('input').value,
        idStanowiska: cells[10].querySelector('input').value,
      };

      fetch('/pracownicy/update', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data),
      }).then(response => {
        if (response.ok) {
          alert('Zmiany zapisane.');
          cells.forEach((cell, index) => {
            if (index < cells.length - 1) {
              cell.textContent = data[Object.keys(data)[index]];
            }
          });
          button.textContent = 'Edytuj';
          button.classList.add('edit-btn');
          button.classList.remove('save-btn');
        } else {
          alert('Wystąpił błąd podczas zapisywania.');
        }
      });
    }
  });

</script>



</body>
</html>
